---
description: Release 7.1.0-M17
---

# 7.1.0-M17

You can consume all the Activiti artifacts for this release from Alfresco Nexus:

```markup
<repositories>
  <repository>
    <id>activiti-releases</id>
    <url>https://artifacts.alfresco.com/nexus/content/repositories/activiti-releases</url>
  </repository>
</repositories>
```

_Activiti Cloud:_

```markup
<dependencyManagement>
   <dependencies>
     <dependency>
       <groupId>org.activiti.cloud</groupId>
       <artifactId>activiti-cloud-dependencies</artifactId>
       <version>7.1.0-M17</version>
       <scope>import</scope>
       <type>pom</type>
     </dependency>
   </dependencies>
 </dependencyManagement>
```

_Activiti Core_

```markup
  <dependencyManagement>
    <dependencies>
      <dependency>
        <groupId>org.activiti</groupId>
        <artifactId>activiti-dependencies</artifactId>
        <version>7.1.0-M17</version>
        <scope>import</scope>
        <type>pom</type>
      </dependency>
    </dependencies>
  </dependencyManagement>
```

### In the milestone 7.1.0-M17 you will find the following [main fixes & features](https://github.com/Activiti/Activiti/milestone/41?closed=1):
- [Improve Query Consumer Event Handling Performance](https://github.com/Activiti/Activiti/issues/3803)
- [Support Horizontal Pod Autoscaling (HPA) on Activiti Cloud full chart](https://github.com/Activiti/Activiti/issues/3791)
- [Change name validation for BPMN process definition and model payload](https://github.com/Activiti/Activiti/issues/3800)
- [Add category field to process models](https://github.com/Activiti/Activiti/issues/3765)
- [JUEL: Add custom function 'list'](https://github.com/Activiti/Activiti/issues/3782)
- [Fix variables propagation logic](https://github.com/Activiti/Activiti/issues/3791)
- [Fix modeling app validation for subprocesses](https://github.com/Activiti/Activiti/issues/3794)
- [Update Spring Boot version to 2.6.2](https://github.com/Activiti/Activiti/issues/3798)

## Changes from previous milestones

* [x] Support Horizontal Pod Autoscaling (HPA) on Activiti Cloud full chart.&#x20;

Kubernetes supports horizontal scalability through Horizontal Pod Autoscaler (HPA) mechanism.
In `activiti-cloud-full-charts` it is now possible to enable HPA for the `runtime-bundle` and `activiti-cloud-query` microservices.

### Requirements
The HorizontalPodAutoscaler can fetch metrics from aggregated APIs that, for Kubernetes (metrics.k8s.io), are provided by an add-on named `Metrics Server`.

So, `Metric Server` needs to be installed and launched to use the HPA feature. Please refer to [this page](https://github.com/kubernetes-sigs/metrics-server) for its installation.

### HPA Configuration

In the `activiti-cloud-full-chart` the HorizontalPodAutoscaler is disabled by default for backward compatibility. Please
add the following configuration to your `values.yaml` to enable and use it:

```yaml
runtime-bundle:
  hpa:
    enabled: true
    minReplicas: 1
    maxReplicas: 6
    cpu: 90
    memory: "2000Mi"
activiti-cloud-query:
  hpa:
    enabled: true
    minReplicas: 1
    maxReplicas: 4
    cpu: 90
```

This configuration (present in the `hpa-values.yaml` file in this repository) enable HPA for both `runtime-bundle` and `activiti-cloud-query`.

> :warning: **WARNING**: the provided values are just an example. Please adjust the values to your specific use case.

#### Configuration Properties

| Name                    | Description                               | Default |
|-------------------------|-------------------------------------------|---------|
| `enabled`               | enables the HPA feature                   | `false` |
| `minReplicas`           | starting number of replicas to be spawned |         |
| `maxReplicas`           | max number of replicas to be spawned      |         |
| `cpu`                   | +1 replica over this average % CPU value  |         |
| `memory`                | +1 replica over this average memory value |         |
| `scalingPolicesEnabled` | enables the scaling policies              | `true`  |

### Scaling Polices

Scaling policies allow Kubernetes to stabilize the number of pods when there are swift fluctuations of the load. The scale-down policies are configured so that:

- only 1 pod can be dismissed every minute.
- only 15% of the number of pods can be dismissed every minute.
- the policy that scales down more pods will be triggered first.

The scale-up policies are the default Kubernetes ones.

These policies are always enabled until a `scalingPolicesEnabled: false` is specified in the configuration.

### Activiti Cloud Query and HPA

**Activiti Cloud** supports both `RabbitMQ` and `Kafka` message broker. **Activiti Cloud Query** is a consumer of the message broker, so we need to be extra careful in the configuration of the automatic scalability in order to keep it working properly.

As a general rule, the automatic horizontal scalability for the query consumers should be enabled only when the Activiti Cloud has enabled `partitioning`.

#### Activiti Cloud Query and HPA with Kafka

In a partitioned installation, Kafka allows the consumers to connect to one or more partitions with the maximum ratio of 1:1 between partitions and consumers.

So when configuring HPA please **don't** specify the `maxReplicas` value greater than the `partitionCount`.

#### Activiti Cloud Query and HPA with RabbitMQ

When partitioning RabbitMQ the configuration will spawn one replica for every partition, so you should avoid activating the `HorizontalPodAutoscaler` in this case.
